#!/bin/bash
dotfiles() {
  SHELL_NAME="$(basename "$SHELL")"
  echo ".${SHELL_NAME}rc"
  echo ".config/ttypty/shell"
  echo ".config/ttypty/completions"
  echo ".gitconfig"
  command -v kitty > /dev/null && echo ".config/kitty"
  command -v lb > /dev/null && echo ".config/lockbox/config.toml"
  command -v nvim > /dev/null && echo ".config/nvim"
  echo ".ssh/"
  echo ".config/git/"
}

DIR=""
SET=""
FILE=""
for SET in $(dotfiles | sort -u); do
  while IFS= read -r -d '' FILE; do
    echo "${FILE//$HOME/}"
    DIR=$(dirname "$FILE")
    [ "$DIR" != "." ] && mkdir -p "$HOME/$DIR"
    CMD="ln -sf"
    $CMD "$PWD/$FILE" "$HOME/$FILE"
  done < <(find "$SET" -type f -print0)
done

libexec() {
  ./libexec/lib/generate "$1"
}

libexec "devtools"
libexec "git-uncommitted"
command -v go > /dev/null && libexec "go-lint" && libexec "go-mod-updates"
